<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MODIStsp_extract — MODIStsp_extract • MODIStsp</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MODIStsp</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MODIStsp.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lbusett/MODIStsp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MODIStsp_extract</h1>
    </div>

    
    <p>function used to extract time series data from rts files created by MODIStsp
on spatial locations provided in the form of "R" spatial objects (spatialPoints,
spatialPolygons, etc.)</p>
    

    <pre class="usage"><span class='fu'>MODIStsp_extract</span>(<span class='no'>in_rts</span>, <span class='no'>sp_object</span>, <span class='kw'>start_date</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>end_date</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>id_field</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='kw'>out_format</span> <span class='kw'>=</span> <span class='st'>"xts"</span>, <span class='kw'>small</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>small_method</span> <span class='kw'>=</span> <span class='st'>"centroids"</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>in_rts</th>
      <td><p>input "rasterStack" or "rasterBrick" object created by MODIStsp (it MUST contain acquisition dates in the "Z" attribute " )</p></td>
    </tr>
    <tr>
      <th>sp_object</th>
      <td><p>"sp" object OR name of an ESRI shapefile specifying the "positions" from which data has to be extracted
If sp_object represents lines, the output object contains one column for each polygon, containing values obtained applying the function
specified as the FUN argument over all pixels touched by the line, and one line for each date.
If sp_object represents points, the output object contains one column for each point, containing values of the cells corresponding to the pint,
and one line for each date.
If sp_object represents polygons, the output object contains one column for each polygon, containing values obtained applying the function
specified as the FUN argument over all pixels belonging to the polygon, and one line for each date</p></td>
    </tr>
    <tr>
      <th>start_date</th>
      <td><p>"Date", "POSIXct" or "POSIXlt" starting date of the period to be considered for data extraction OR character string cohercible to
Date class (format = "yyyy-mm-dd"). If not provided, the starting date of the rasterstack is used.</p></td>
    </tr>
    <tr>
      <th>end_date</th>
      <td><p>"Date", "POSIXct" or "POSIXlt" ending date of the period to be considered for data extraction OR character string cohercible to
Date class (format = "yyyy-mm-dd").If not provided, the ending date of the rasterstack is used.</p></td>
    </tr>
    <tr>
      <th>id_field</th>
      <td><p>character name of the column of the input sp object or shapefile to be used in the data extraction. Values conatined in the column MUST be unique
The names of the columns of the output are taken from this column. If not provided, or an invalid value is provided, then the names of the columns of the output
reflect the number of the feature in the original sp object or shapefile.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>function to summarize the values (e.g. mean) on polygon data frames. The function should take a single numeric vector as argument and return a
single value (e.g. mean, min or max), and accept a na.rm argument. Thus, standard R functions not including an na.rm argument must
be wrapped as in this example: fun=function(x,...)length(x). Defaults to "mean"</p></td>
    </tr>
    <tr>
      <th>out_format</th>
      <td><p>character "xts" or "dframe". default to 'xts'. If dframe, the output is a data frame with dates in the first column and extracted data in the others</p></td>
    </tr>
    <tr>
      <th>small</th>
      <td><p>logical If set to TRUE, and input is polygons, then values are returned also for polygons not covering at least one raster cell. "Included"
cells in this case depend on the values of the "small_method" parameter.</p></td>
    </tr>
    <tr>
      <th>small_method</th>
      <td><p>string 'centroids' or 'full'. if small == T and input is polygons, controls which cells are "extracted" for small polygons. If set to
centroids (default), then only the cells corresponding to polygon centroid are considered (faster, may have problems on strangely shaped polygons). If set to
"full", then all cells intersected by the small polygon are extracted and used in calculation.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Logical If TRUE, and sp_object is a polygon, then na.rm = T is used when applying the function
to the different pixels of the polygon. Default = T.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical If TRUE, messages on extraction completion are sent out. Default = T.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data.frame or xts object. Each column of data corresponds to one point or one polygon</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function takes as input a rasterStack object containing time information in the "z" attribute (set by "raster" function "SetZ"),
a starting and ending date  and a standard "R" spatial object, and returns the time series for the spatial locations
specified in the spatial object in the form of a "R" xts object ORr a plain data.frame with a "date" column in first position.
If the input spatial object is a "point" or "line" one, the  output object contains one column for each specified point, or for each cell
intersecting the line, and one line for each date. If the input spatial object is a "polygon" one, the output object contains one column
for each polygon, containing values obtained applying the function specified as the FUN
argument over all pixels belonging to the polygon, and one line for each date.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>License: GPL 3.0</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'># Extract average and standard deviation values from a rts object created by MODIStsp
# for each polygon of a shapefile, for each date in the period between 2001-01-01 and 2014-12-31
</div><span class='co'># NOT RUN {</span>
<span class='co'>#Set the inputs</span>
<span class='no'>infile</span> <span class='kw'>&lt;-</span> <span class='st'>"in_path/MOD13Q1_MYD13Q1_NDVI_49_2000_353_2015_RData.RData"</span>  <span class='co'># Input rts file</span>
<span class='no'>shpname</span> <span class='kw'>&lt;-</span> <span class='st'>"path_to_file/rois.shp"</span>  <span class='co'># Path to Polygon Shapefile</span>
<span class='no'>startdate</span> <span class='kw'>&lt;-</span> <span class='fu'>as.Date</span>(<span class='st'>"2010-01-01"</span>)  <span class='co'># Start date for extraction</span>
<span class='no'>enddate</span> <span class='kw'>&lt;-</span> <span class='fu'>as.Date</span>(<span class='st'>"2014-12-31"</span>)    <span class='co'># End date for extraction</span>
<span class='co'>#Load Data</span>
<span class='no'>inrts</span> <span class='kw'>&lt;-</span> <span class='fu'>get</span>(<span class='fu'>load</span>(<span class='no'>infile</span>))          <span class='co'># Load the rts file</span>
<span class='co'># Compute average and St.dev</span>
<span class='no'>dataavg</span> <span class='kw'>&lt;-</span> <span class='fu'>MODIStsp_extract</span>(<span class='no'>inrts</span>,<span class='no'>shpname</span>, <span class='no'>startdate</span>, <span class='no'>enddate</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='st'>'mean'</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='no'>T</span>)
<span class='no'>datasd</span> <span class='kw'>&lt;-</span> <span class='fu'>MODIStsp_extract</span>(<span class='no'>inrts</span>,<span class='no'>shpname</span>,  <span class='no'>startdate</span>,  <span class='no'>enddate</span>,  <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='st'>'sd'</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='no'>T</span>)
<span class='fu'>plot</span>(<span class='no'>dataavg</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Lorenzo Busetto, phD (2015)
email: busetto.l@irea.cnr.it

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Lorenzo Busetto, Luigi Ranghetti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
